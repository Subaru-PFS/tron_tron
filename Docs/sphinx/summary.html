<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.8.1: http://docutils.sourceforge.net/" />
<title>Overview</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7056 2011-06-17 10:50:48Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="overview">
<h1 class="title">Overview</h1>

<p>Tron provides a distributed communication system, with the following
basic features:</p>
<blockquote>
<ul class="simple">
<li>&quot;commanders&quot; send commands to &quot;actors&quot;, via a central hub. Actors can also be commanders.</li>
<li>actors reply to commands and generate status keywords. Also via the hub.</li>
<li>actors are expected to completely describe their state by generating keyword variables whenever state changes.</li>
<li>command and replies are sent using line-oriented ASCII protocols</li>
<li>finally, by default the hub broadcasts all actor traffic to all commanders.</li>
</ul>
</blockquote>
<p>The net result is that commanders passively always have an up-to-date view of all
actor state.</p>
<div class="section" id="commands">
<h1>Commands</h1>
<p>The command protocol into the tron hub is a line-oriented ASCII
protocol, with only a little imposed structure. Commands are sent
from &quot;commanders&quot; to &quot;actors&quot;, and the actors reply to them, or
spontaneously generate status keywords.</p>
<p>There are a few variants, but in the normal case, the protocol between
commanders and the hub:</p>
<pre class="literal-block">
commandID targetActor commandString
</pre>
<p>Two examples, assuming out commander had already sent 11 command via
the hub:</p>
<pre class="literal-block">
12 telescope slew 90,30
13 spec2 expose science time=30.0
</pre>
<p>CommandID should be a positive incrementing integer, but is only
meaningful for the commander. The commander is externally identified
with some commanderName, which is either negotiated (for human
connections) or assigned (for program connections) when it first
connects to the hub.  For this example, assume the commanderName is
&quot;Joe&quot;.  The hub does not parse or translate the commandString.</p>
<p>The hub slightly translates these incoming commands when sending them
to the actors. It assigns the outgoing command a positive and
incrementing actorCommandID, so that it can track completion
status. Most actors only need to know that ID and the original
commandtext:</p>
<pre class="literal-block">
actorCommandID commandString
</pre>
<p>For the first example, the hub would be sent the telescope:</p>
<pre class="literal-block">
134 slew 90,30
</pre>
<p>For the second example above the spec2 actor would be sent:</p>
<pre class="literal-block">
967 expose science time=30.0
</pre>
<p>There are a couple of common extensions to this protocol. If an actor
also sends commands to other actors, it will be configured to also be
sent commanderName.commandID, which it in turn appends its own
identity to when sending commands. The idea is to be able to track
commands back to their origin. So, the spec2 actor could have been
configured to be sent:</p>
<pre class="literal-block">
967 Joe.12 expose science time=30.0
</pre>
<p>which spec2 commend could generate:</p>
<pre class="literal-block">
32 Joe.12.spec2.967 telescope offset focus -10
</pre>
<p>which would be sent to the telescope as:</p>
<pre class="literal-block">
135 offset focus -10
</pre>
</div>
<div class="section" id="replies">
<h1>Replies</h1>
<p>A actor replies to commands with the actorCommandID the hub sent, and
a single status flag:</p>
<p>actorCommandID flag [keywords]</p>
<p>Each command _must_ be finished with exactly one reply with one of
the following two flags:</p>
<pre class="literal-block">
:   - successful command completion
f   - command failure
</pre>
<p>Optionally, each command can send along other, non-terminating,
replies:</p>
<pre class="literal-block">
i   - &quot;intermediate&quot; reply.
w   - &quot;intermediate&quot; reply indicating some warning.
</pre>
<p>For the above example commands:</p>
<pre class="literal-block">
134 i text=&quot;slewing to 90,30&quot;
134 i az=90; alt=30; rot=0
134 :

135 : focus=1000

967 i exposureID=123
967 i exposureState=&quot;Flushing&quot;
967 i exposureState=&quot;Integrating&quot;; shutter=&quot;open&quot;
967 i exposureState=&quot;Reading&quot;; shutter=&quot;closed&quot;
967 : exposureState=&quot;Done&quot;; filename=&quot;PFSA000012302.fits&quot;
</pre>
<p>The command IDs get (un-)translated each time they go through the
hub, so that the command sender can associate replies with its own
command IDs. And for slightly fiddly reasons, the source of the reply
is also added [the hub can reply if no the actor cannot be connected
to, say]. So for the above commands the original commander would see:</p>
<pre class="literal-block">
User.Joe 12 telescope i text=&quot;slewing to 90,30&quot;
User.Joe 12 telescope i az=90; alt=30; rot=0
User.Joe 12 telescope :

spec2 32 telescope : focus=1000

User.Joe 13 spec2 i exposureID=123
User.Joe 13 spec2 i exposureState=&quot;Flushing&quot;
User.Joe 13 spec2 i exposureState=&quot;Integrating&quot;; shutter=&quot;open&quot;
User.Joe 13 spec2 i exposureState=&quot;Reading&quot;; shutter=&quot;closed&quot;
User.Joe 13 spec2 : exposureState=&quot;Done&quot;; filename=&quot;PFSA000012302.fits&quot;
</pre>
<p>This may not have been the best choice.</p>
</div>
<div class="section" id="keywords">
<h1>Keywords</h1>
<p>See the reference documentation.</p>
</div>
</div>
</body>
</html>
